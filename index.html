<!DOCTYPE html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Steak - Data Visualized</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
  integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <link rel="stylesheet" href="styles/dc.css">
  <link rel="stylesheet" href="styles/styles.css">
  <style>
    .dc-chart g.row text {
      fill: #020000;
    }
    .container {
      min-width: 1600px;
    }
    .chart-title {
      font-weight: 500;
    }
  </style>
</head>

<body>
  <nav class = 'navbar navbar-dar bg-dark'>
    
  </nav>
  <h1>Charts here</h1>
  <div id="steak-chart"></div>
  <div id="smoke-chart"></div>
  <div id="drink-chart"></div>
  <div id="cheat-chart"></div>

  <script src="js/crossfilter.js"></script>
  <script src="js/d3.js"></script>
  <script src="js/dc.js"></script>
  <script src="js/underscore-min.js"></script>
  <script type="text/javascript">

  var ndx;

  var steakChart = dc.pieChart("#steak-chart");
  // var smokeChart = dc.rowChart("#smoke-chart");
  // var drinkChart = dc.rowChart("#drink-chart");
  // var cheatChart = dc.rowChart("#cheat-chart");

  d3.csv('steak.csv').then(function(data) {
    console.log('data first length', data.length);
    data = _.filter(data, function(d) { return d.id});
    console.log('data', data.length);
      
 

  ndx = crossfilter(data);
  var all = ndx.groupAll();


var prepSteakDim = ndx.dimension(function(d) { return d["prepSteak"]});
var prepSteakGroup = prepSteakDim.group();

var smokeDim = ndx.dimension(function(d) { return d["smoke"]});
var smokeGroup = smokeDim.group();

var drinkDim = ndx.dimension(function(d) { return d["drink"]});
var drinkGroup = drinkDim.group();

var cheatDim = ndx.dimension(function(d) { return d["cheat"]});
var cheatGroup = cheatDim.group();

var allDim = ndx.dimension(function(d) { return d;});

steakChart
  .width(250)
  .height(250)
  .slicesCap(5)
  .innerRadius(60)
  .dimension(prepSteakDim)
  .group(prepSteakGroup)
  .on('pretransition', function(chart) {
    chart.selectAll('text.pie-slice').text(function(d) {
      return d.data.key + ' '+ dc.ultils.pringSingleValue((d.endAngle - d.startAngle) / (2*Math.PI) * 100) + '%';
    })
  });

  dc.renderAll();
});
  </script>
</body>
</html>
